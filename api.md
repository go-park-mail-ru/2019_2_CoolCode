## 0. Cущности
### 0.1 Пользователь
```json
{
     "id":"int",
     "email":"string",
     "password":"string",
     "username":"string",
     "name":"string",
     "status":"string",
     "phone":"string"
}
```
    
| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `username`    | Логин  пользователя. |
| `password`    | Пароль пользователя |
| `id`     | Id пользователя |
| `email`     | Email пользователя |
| `name`     | Реальное имя пользователя |
| `status`     | Статус пользователя |  
| `phone`     | Телефон пользователя |  

### 0.2 Чат(1-1)
```json
{
  "id":"int",
  "name": "string",
  "totalMsgCount": "int",
  "members": ["int"]
  
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `id`    | Уникальный идентификатор чата. |
| `name`    | Название чата(имя собеседника) |
| `totalMsgCount`     | Количество новых сообщений на момент запроса |
| `members`     | id пользователей, имеющих доступ к чату(2 числа) |

### 0.3 Канал
```json
{
  "id": "int",
  "name": "string",
  "totalMsgCount": "int", 
  "members": ["int"],
  "admins": ["int"],
  "creator": "int"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `id`    | Уникальный идентификатор канала. |
| `name`    | Название канала |
| `totalMsgCount`     | Количество новых сообщений на момент запроса |
| `members`     | id пользователей, имеющих доступ к каналу |
| `admins`     | id пользователей, имеющих доступ к редактировнию канала|
| `creator`     | id пользователя, создавшего канал|

### 0.4 Workspace
```json
{
  "id": "int",
  "name": "string",
  "channels":  [{
      "id": "int",
      "name": "string",
      "totalMsgCount": "int", 
      "members": ["int"],
      "admins": ["int"],
      "creator": "int"
  }], 
  "members": ["int"],
  "admins": ["int"],
  "creator": "int"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `id`    | Уникальный идентификатор workspace. |
| `name`    | Название workspace |
| `channels`    | Массив каналов внутри workspace |
| `members`     | id пользователей, имеющих доступ к workspace |
| `admins`     | id пользователей, имеющих доступ к редактировнию workspace|
| `creator`     | id пользователя, создавшего workspace|







## 1. Общие положения

Все запросы посылаются на сервер <тут адрес>. Если запрос не содержит в себе тело, то он `GET`, иначе `POST`

### 1.1 Типы http кодов, возвращаемых сервером в ответе

| Код       | Описание |                                                                                                                                                            
| -------------- | -------------------------------------------------------------------------------|
| `200`      | Успех. |
| `400`    | Неверные данные в запросе (неправильный логин/пароль, несуществующий ID заданий, пользователей). Тело ответа дополнительно содержит мнемокод с описанием ошибки, завернутый в JSON.|
| `401`      | Клиент не авторизован. |
| `403`      | Клиент не имеет доступ к данному запросу. |
| `405`      | Неверный метод (например, `POST` вместо `GET` для `/get_school_list`). `GET` используется в тех запросах, где не надо посылать json в теле |
| `500`      | Фатальная ошибка на сервере. |

# 2. Пользователь

### 2.1 Регистрация

Ниже указан запрос клиента на авторизацию.

Запрос `/users` типа POST

```json
{
    "email": "string",
    "password": "string"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `email`       | Email нового пользователя. |
| `password`     | Пароль нового пользователя |

Запрос так же может содержать любые другие поля пользователя

Ответ на запрос: код ошибки


### 2.2 Авторизация

Ниже указан запрос клиента на авторизацию.

Запрос `POST` `login`

```json
{
    "email": "string",
    "password": "string"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `email`       | Email  пользователя. |
| `password`     | Пароль пользователя |

Ответ на запрос:

Заголовок ответа содержит ключ `Set-Cookie`. Значение - ключ  - session_id.

```json
 {
      "id":"int",
      "email":"string",
      "username":"string",
      "name":"string",
      "status":"string"
 }
```
    
  | Ключ          | Значение                                                                                                                                                                                                                                                                               |
    | ------------- | ----------------------------------------- |
    | `username`    | Логин  пользователя. |
    | `id`     | Id пользователя |
    | `email`     | Email пользователя |
    | `name`     | Реальное имя пользователя |
    | `status`     | Статус пользователя |  
    
### 2.3 Проверка сессии

Ниже указан запрос клиента на авторизацию.

Запрос `GET` `/users`

Ответ на запрос:

Заголовок ответа содержит ключ `Set-Cookie`. Значение - ключ  - session_id.

```json
 {
      "id":"int",
      "email":"string",
      "username":"string",
      "name":"string",
      "status":"string"
 }
```
    
  | Ключ          | Значение                                                                                                                                                                                                                                                                               |
    | ------------- | ----------------------------------------- |
    | `username`    | Логин  пользователя. |
    | `id`     | Id пользователя |
    | `email`     | Email пользователя |
    | `name`     | Реальное имя пользователя |
    | `status`     | Статус пользователя |  
        
### 2.3 Выход

Выход есть отвязка соединения от устройства и аккаунта.

Запрос `DELETE` `/logout` 

Ответ на запрос:

Код http `200` в случае успеха, а код, описывающий ошибку, в ином случае.

После после получения ответа этого типа неуместны никакие другие запросы, кроме `/login`,`/sign_up`.

### 2.4 Запрос информации о пользователе

Запрос `GET` `/users/{id}`. Доступен только для авторизированного пользователя

Ответ:
```json
 {
      "id":"int",
      "email":"string",
      "username":"string",
      "name":"string",
      "status":"string"
 }
```

### 2.5 Запрос информации о пользователе

Запрос `GET` `/users`. Доступен только для авторизированного пользователя. Возвращает пользователя, привязанного к текущей сессии.

Ответ:
```json
 {
      "id":"int",
      "email":"string",
      "username":"string",
      "name":"string",
      "status":"string"
 }
```

### 2.6 Редатирование профиля
Редактирование полей профиля
    
Запрос `/users/id` типа PUT 
    
Тело запроса должно содержать ВСЕГО пользователя, а не только редактируемые поля
    
```json
 {
      "id":"int",
      "email":"string",
      "username":"string",
      "name":"string",
      "status":"string"
 }
```
    
    
### 2.6 Получение аватарки
Запрос /photos/{id} типа GET

Ответ: multipart/form-data

    
### 2.7 Загрузка аватарки
Запрос /photos типа POST

Тип данных multipart/form-data

Ответ: код ошибки

### 2.8 Поиск пользователей по username
Запрос /users/<name> типа GET

Ответ содержит всех пользователей, username которые содержит <name>
```json
{
  "users":[
    {
           "id":"int",
           "email":"string",
           "password":"string",
           "username":"string",
           "name":"string",
           "status":"string",
           "phone":"string"
    },
  ]
}
```



# 3 Чаты

### 3.1 Cоздание чата
Запрос /chats типа POST

Тело запроса:
```json
{
  "user_id": "int"
} 
```
//TODO: CHAT JSON

###3.2 Получение чатов пользователя
Запрос /users/{id}/chats типа GET

Тело ответа:
```json
{
  "chats": [
    {
      
    }
  ],
  "workspaces": [
      {
      
      }
  ]
}
```

### 3.3 Подписаться на уведомления чата
 Websocket запрос chats/{id}/notifications
 
# 4 Workspaces

### 4.1 Создание workspace 

Запрос `POST` `/workspaces`

```json
{
  "name": "string"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `name`       | Название workspace. |

Ответ:

```json
{
  "id": "int",
  "name": "string",
  "members": ["int"],
  "admins": ["int"],
  "creator": "int"
}
```

### 4.2 Редактирование workspace
Запрос типа `PUT` `workspaces/{id}`. Доступ имеют только админы workspace

```json
{
  "id": "int",
  "name": "string",
  "members": ["int"],
  "admins": ["int"]
}
```

### 4.3 Выход из workspace

Запрос `DELETE` `/workspaces/{id}/members`

```json
{
  "id": "int"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `id`       | id workspace |

### 4.4 Удаление workspace
Доступ к запросу имеет только создатель workspace
Запрос `DELETE` `/workspaces/{id}`

```json
{
  "id": "int"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `id`       | id workspace |

# 5 Каналы

### 5.1 Создание канала 
Запрос `POST` `/workspaces/{id}/channels`

```json
{
   "name": "string"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `name`       | Название канала. |

Ответ:

```json
{
  "id": "int",
  "name": "string",
  "totalMsgCount": "int", 
  "members": ["int"],
  "admins": ["int"],
  "creator": "int"
}
```

### 5.2 Редактирование канала
Запрос типа `PUT` `channels/{id}`. Доступ имеют только админы канала

```json
{
  "id": "int",
  "name": "string",
  "members": ["int"],
  "admins": ["int"]
}
```

### 4.3 Выход из канала

Запрос `DELETE` `/channels/{id}/members`

```json
{
  "id": "int"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `id`       | id канала |

### 4.4 Удаление канала
Доступ к запросу имеет только создатель канала
Запрос `DELETE` `/channels/{id}`

```json
{
  "id": "int"
}
```

| Ключ          | Значение                                                                                                                                                                                                                                                                               |
| ------------- | ----------------------------------------- |
| `id`       | id канала |











 


    
    
    
